<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-advanced/specifics" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Specifics | Scrut</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://internalfb.com/scrut/docs/advanced/specifics/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Specifics | Scrut"><meta data-rh="true" name="description" content="This chapter describes behaviors of Scrut that should be known by the user to prevent surprises in the wrong moment."><meta data-rh="true" property="og:description" content="This chapter describes behaviors of Scrut that should be known by the user to prevent surprises in the wrong moment."><link data-rh="true" rel="icon" href="/scrut/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://internalfb.com/scrut/docs/advanced/specifics/"><link data-rh="true" rel="alternate" href="https://internalfb.com/scrut/docs/advanced/specifics/" hreflang="en"><link data-rh="true" rel="alternate" href="https://internalfb.com/scrut/docs/advanced/specifics/" hreflang="x-default"><link rel="stylesheet" href="/scrut/assets/css/styles.c8f34039.css">
<script src="/scrut/assets/js/runtime~main.749be10e.js" defer="defer"></script>
<script src="/scrut/assets/js/main.4f0c8466.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/scrut/"><div class="navbar__logo"><img src="/scrut/img/logo.svg" alt="Scrut Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/scrut/img/logo.svg" alt="Scrut Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Scrut</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/scrut/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/scrut" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/scrut/docs/">Scrut</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/scrut/docs/tutorial/">Tutorial</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/scrut/docs/advanced/file-formats/">Advanced Topics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scrut/docs/advanced/file-formats/">File Formats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scrut/docs/advanced/expectations/">Expectations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/scrut/docs/advanced/specifics/">Specifics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/scrut/docs/advanced/development/">Development</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/scrut/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Advanced Topics</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Specifics</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Specifics</h1>
<p>This chapter describes behaviors of Scrut that should be known by the user to prevent surprises in the wrong moment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-output">Test output<a href="#test-output" class="hash-link" aria-label="Direct link to Test output" title="Direct link to Test output">​</a></h2>
<p>Executing a test with Scrut results either in success (when all expectations in the test match) or failure (when at least one expectation in the test does not match).</p>
<p>Scrut supports multiple <em>output renderers</em>, which yield a different representation of the test results.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pretty-renderer-default">Pretty Renderer (default)<a href="#pretty-renderer-default" class="hash-link" aria-label="Direct link to Pretty Renderer (default)" title="Direct link to Pretty Renderer (default)">​</a></h3>
<p>Scrut will always tell you what it did:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ scrut test selftest/cases/regex.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Result: 1 file(s) with 8 test(s): 8 succeeded, 0 failed and 0 skipped</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In case of failure the <code>pretty</code> default renderer will provide a human-readable output that points you to the problem with the output:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ scrut test a-failing-test.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// =============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// @ /path/to/a-failing-test.md:10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// -----------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// # One conjunct expression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// -----------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// $ echo Foo &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//   echo Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// =============================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1  1  |   Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   2  | - BAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2     | + Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3     | + Baz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The failure output consists of two components:</p>
<ol>
<li>The failure header, which consists of all initial lines that start with <code>//</code>, indicates the position</li>
<li>The failure body, which consists of all the following lines, indicates the problem</li>
</ol>
<p><strong>Header</strong></p>
<p>The header contains three relevant information. Given the above output:</p>
<ul>
<li><code>@ /path/to/a-failing-test.md:4</code>, tells you that the test that failed is in the provided file <code>/path/to/a-failing-test.md</code> and that the shell expression (that failed the test) starts in line four of that file.</li>
<li><code># &lt;test title&gt;</code>, gives you the optional title of the test in the file. See <a href="/scrut/docs/advanced/file-formats/">File Formats</a>) to learn more. <em>If the test does not have a title, this line is omitted.</em></li>
<li><code>$ &lt;test command&gt;</code>, is the shell expectation from the test file that is tested and that has failed. Again, see <a href="/scrut/docs/advanced/file-formats/">File Formats</a>) for more information.</li>
</ul>
<p><strong>Body</strong></p>
<p>There are two possible variants that the <code>diff</code> renderer may return:</p>
<ol>
<li>Failed <a href="/scrut/docs/advanced/expectations/">output expectations</a></li>
<li>Failed <a href="#exit-codes">exit code expectation</a></li>
</ol>
<p>The above output is a failed output expectations and you can read it as following:</p>
<ul>
<li><code>1  1  |   Foo</code>: This line was printed as expected. The left hand <code>1</code> is the number of the output line and the right hand <code>1</code> is the number of the expectation.</li>
<li><code>   2  | - BAR</code>: This line was expected, but not printed. The left hand omitted number indicates that it was not found in output. The right hand number tells that this is the second expectation. The <code>-</code> before the line <code>Bar</code> emphasizes that this is a missed expectation.</li>
<li><code>2     | + Bar</code>: This line was printed and expected. The left hand <code>2</code> is the number of the output line and the right hand <code>3</code> is the number of the expectation.</li>
<li><code>3     | + Baz</code>: This line was printed unexpectedly. The left hand <code>3</code> is the number of the output line the omitted right hand number implies there is no expectation that covers it. The <code>+</code> before the line <code>Zoing</code> emphasizes that this is a &quot;surplus&quot; line.</li>
</ul>
<blockquote>
<p><strong>Note</strong>: If you work with test files that contain a large amount of tests, then you may want to use the <code>--absolute-line-numbers</code> flag on the command line: instead of printing the relative line number for each test, as described above, it prints absolute line numbers from within the test file. Assuming the <code>Foo</code> expectation from above is in line 10 of a file, it would read <code>13  13  |   Foo</code> - and all subsequent output liens with respective aligned line numbers.</p>
</blockquote>
<p>An example for the body of an <em>exit code expectation</em>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">unexpected exit code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expected: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  actual:   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## STDOUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#&gt; Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## STDERR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This should be mostly self-explanatory. Scrut does not provide any output expectation failures, because it assumes that when the exit code is different, then it is highly likely that the output is very different - and even if not, it would not matter, as it failed anyway.</p>
<p>The tailing <code>## STDOUT</code> and <code>## STDERR</code> contain the output lines (prefixed with <code>#&gt; </code>) that were printed out from the failed execution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="diff-renderer">Diff renderer<a href="#diff-renderer" class="hash-link" aria-label="Direct link to Diff renderer" title="Direct link to Diff renderer">​</a></h3>
<p>The <code>diff</code> renderer, that can be enabled with <code>--renderer diff</code> (or <code>-r diff</code>), prints a diff in the <a href="https://en.wikipedia.org/wiki/Diff#Unified_format" target="_blank" rel="noopener noreferrer">unified format</a>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ scrut test -r diff a-failing-test.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--- /path/to/a-failing-test.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ /path/to/a-failing-test.md.new</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@@ -14 +14,2 @@ malformed output: One conjunct expression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-BAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+Baz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>Note</strong>: The created diff is compatible with the <code>patch</code> command line tool (e.g. <code>patch -p0 &lt; &lt;(scrut test -r diff a-failing-test.md)</code>).</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-and-yaml-renderer">JSON and YAML renderer<a href="#json-and-yaml-renderer" class="hash-link" aria-label="Direct link to JSON and YAML renderer" title="Direct link to JSON and YAML renderer">​</a></h3>
<p>These renderer are primarily intended for automation and are to be considererd experimental.
You can explore them using <code>--renderer yaml</code> or respective <code>--renderer json</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-environment-variables">Test environment variables<a href="#test-environment-variables" class="hash-link" aria-label="Direct link to Test environment variables" title="Direct link to Test environment variables">​</a></h2>
<p>Scrut sets a list of environment variables for the execution. These are set <em>in addition to and overwriting</em> any environment variables that are set when <code>scrut</code> is being executed.</p>
<blockquote>
<p><strong>Note</strong>: If you need an empty environment, consider executing using <a href="https://man7.org/linux/man-pages/man1/env.1.html" target="_blank" rel="noopener noreferrer"><code>env</code></a>, like <code>env -i scrut test ..</code> instead</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scrut-specific-environment-variables">Scrut specific environment variables<a href="#scrut-specific-environment-variables" class="hash-link" aria-label="Direct link to Scrut specific environment variables" title="Direct link to Scrut specific environment variables">​</a></h3>
<ul>
<li><code>TESTDIR</code>: contains the absolute path of the directory where the file that contains the test that is currently being executed is in</li>
<li><code>TESTFILE</code>: contains the name of the file that contains the test that is currently being executed</li>
<li><code>TESTSHELL</code>: contains the shell that in which the test is being executed in (default <code>/bin/bash</code>, see <code>--shell</code> flag on commands)</li>
<li><code>TMPDIR</code>: contains the absolute path to a temporary directory that will be cleaned up after the test is executed. This directory is shared in between all executed tests across all test files.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-linux-environment-variables">Common (linux) environment variables<a href="#common-linux-environment-variables" class="hash-link" aria-label="Direct link to Common (linux) environment variables" title="Direct link to Common (linux) environment variables">​</a></h3>
<ul>
<li><code>CDPATH</code>: empty</li>
<li><code>COLUMNS</code>: <code>80</code></li>
<li><code>GREP_OPTIONS</code>: empty</li>
<li><code>LANG</code>: <code>C</code></li>
<li><code>LANGUAGE</code>: <code>C</code></li>
<li><code>LC_ALL</code>: <code>C</code></li>
<li><code>SHELL</code>: Same as <code>TESTSHELL</code>, see above</li>
<li><code>TZ</code>: <code>GMT</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-cram-environment-variables">(Optional) Cram environment variables<a href="#optional-cram-environment-variables" class="hash-link" aria-label="Direct link to (Optional) Cram environment variables" title="Direct link to (Optional) Cram environment variables">​</a></h3>
<p>When using the <code>--cram-compat</code> flag, or when a Cram <code>.t</code> test file is being executed, the following additional environment variables will be exposed for compatibility:</p>
<ul>
<li><code>CRAMTMP</code>: if no specific work directory was provided (default), then it contains the absolute path to the temporary directory in which per-test-file directories will be created in which those test files are then executed in (<code>CRAMTMP=$(realpath &quot;$(pwd)/..&quot;)</code>); otherwise the path to the provided work directory</li>
<li><code>TMP</code>: same as <code>TMPDIR</code></li>
<li><code>TEMP</code>: same as <code>TMPDIR</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-work-directory">Test work directory<a href="#test-work-directory" class="hash-link" aria-label="Direct link to Test work directory" title="Direct link to Test work directory">​</a></h2>
<p>By default <code>scrut</code> executes all tests in a dedicated directory <em>per test file</em>. This means <em>all tests within one file are being executed in the same directory</em>. The directory is created within the system temporary directory. It will be removed (including all the files or directories that the tests may have created) after all tests in the file are executed - or if the execution of the file fails for any reason.</p>
<p>This means something like the following can be safely done and will be cleaned up by Scrut after the test finished (however it finishes):</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> Some test that creates a file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token code punctuation" style="color:#393A34">```</span><span class="token code code-language">scrut</span><span class="token code"></span><br></span><span class="token-line" style="color:#393A34"><span class="token code"></span><span class="token code code-block language-scrut">$ date &gt; file</span><span class="token code"></span><br></span><span class="token-line" style="color:#393A34"><span class="token code"></span><span class="token code punctuation" style="color:#393A34">```</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The </span><span class="token code-snippet code keyword" style="color:#00009f">`file`</span><span class="token plain"> lives in the current directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token code punctuation" style="color:#393A34">```</span><span class="token code code-language">scrut</span><span class="token code"></span><br></span><span class="token-line" style="color:#393A34"><span class="token code"></span><span class="token code code-block language-scrut">$ test -f &quot;$(pwd)/file&quot;</span><span class="token code"></span><br></span><span class="token-line" style="color:#393A34"><span class="token code"></span><span class="token code punctuation" style="color:#393A34">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The directory within which tests are being executed can be explicitly set using the <code>--work-directory</code> parameter for the <code>test</code> and <code>update</code> commands. If that parameter is set then <em>all tests</em> from <em>all test files</em> are executed run within that directory, and the directory is <em>not removed</em> afterwards.</p>
<blockquote>
<p><strong>Note</strong>: In addition to the work directory Scrut also creates and cleans up a temporary directory, that is accessible via <code>$TMPDIR</code>. Tools like <code>mktemp</code> automatically use it (from said environment variable).</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-execution">Test execution<a href="#test-execution" class="hash-link" aria-label="Direct link to Test execution" title="Direct link to Test execution">​</a></h2>
<p>As Scrut is primarily intended as an integration testing framework for CLI applications, it is tightly integrated with the shell.
Each Scrut test must define a <a href="/scrut/docs/advanced/file-formats/#test-case-anatomy">shell expression</a> (called an &quot;execution&quot;).
Each of those executions is then run within an actual shell (bash) process, as they would be when a human or automation would execute the expression manually on the shell.</p>
<p>With that in mind:</p>
<ul>
<li>Each execution from the same test file is executed in an individual shell process.<!-- -->
<ul>
<li>Scrut currently only supports <code>bash</code> as shell process.</li>
<li>Each subsequent execution within the same file inherits the state of the previous execution: environment variables, shell variables, functions, settings (<code>set</code> and <code>shopt</code>).</li>
</ul>
</li>
<li>Tests within the same file are executed in sequential order.</li>
<li>Executions happen in a <a href="#test-work-directory">temporary work directory</a>, that is initially empty and will be cleaned up after the last executions of the test file has run (or when executions are <a href="#skip-tests-with-exit-cod">skipped</a>).</li>
<li>Executions may be detached, but Scrut will not clean up (kill) or wait for detached child processes<!-- -->
<ul>
<li>If you want to run your process in the background or detach, see the <code>detached</code> setting in the <a href="/scrut/docs/advanced/file-formats/#testcase-configuration">testcase configuration</a> page.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-within-a-custom-shell">Execution within a custom shell<a href="#execution-within-a-custom-shell" class="hash-link" aria-label="Direct link to Execution within a custom shell" title="Direct link to Execution within a custom shell">​</a></h3>
<p>While Scrut currently only supports <code>bash</code> (&gt;= 3.2) a custom shell can be provided with the <code>--shell</code> command line parameter.
To understand how that works consider the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ echo &quot;echo Hello&quot; | /bin/bash -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>What the above does is piping the string <code>echo Hello</code> into the <code>STDIN</code> of the process that was started with <code>/bin/bash -</code>.
Scrut pretty much does the same with each shell expressions within a test file.</p>
<p>So why provide a custom <code>--shell</code> then?
This becomes useful in two scenarios:</p>
<ol>
<li>You need to execute the same code before Scrut runs each individual expression</li>
<li>You need Scrut to execute each expression in some isolated environment</li>
</ol>
<p>For (1) consider the following code:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># do something in this wrapper script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /my/custom/setup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run_my_custom_setup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># consume and run STDIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /dev/stdin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For (2) consider the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># do something in this wrapper script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source /my/custom/setup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run_my_custom_setup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># end in a bash process that will receive STDIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exec ssh username@acme.tld /bin/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Instead of SSHing into a machine, consider also running a bash process in docker container.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="stdout-and-stderr">STDOUT and STDERR<a href="#stdout-and-stderr" class="hash-link" aria-label="Direct link to STDOUT and STDERR" title="Direct link to STDOUT and STDERR">​</a></h2>
<p>Commands-line applications can generate output on to two streams: <code>STDOUT</code> and <code>STDERR</code>. There is no general agreement on which stream is supposed to contain what kind of data, but commonly <code>STDOUT</code> contains the primary output and <code>STDERR</code> contains logs, debug messages, etc. This is also the recommendation of the <a href="https://clig.dev/#:~:text=primary%20output%20for%20your%20command" target="_blank" rel="noopener noreferrer">CLI guidelines</a>.</p>
<p>Scrut validates CLI output via <a href="/scrut/docs/advanced/expectations/">Expectations</a>. Which output that entails can be configured via the <a href="/scrut/docs/advanced/file-formats/#testcase-configuration"><code>output_stream</code> configuration directive</a> (and the <code>--(no-)combine-output</code> command-line parameters).</p>
<p><strong>Note:</strong> While you can configure which output streams Scrut considers when evaluating output expecations, you can also steer this by using stream control bash primitives like <code>some-command 2&gt;&amp;1</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exit-codes">Exit Codes<a href="#exit-codes" class="hash-link" aria-label="Direct link to Exit Codes" title="Direct link to Exit Codes">​</a></h2>
<p>You can denote the expected exit code of a shell expression in a testcase. For example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The command is expected to end with exit code 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```scrut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ some-command --foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">an expected line of output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Unless otherwise specified an exit code of 0 (zero) is assumed. You can explicitly denote it with <code>[0]</code> if you prefer.</p>
<blockquote>
<p><strong>Note</strong>: Exit code evaluation happens before output expectations are evaluated.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="skip-tests-with-exit-code-80">Skip Tests with Exit Code 80<a href="#skip-tests-with-exit-code-80" class="hash-link" aria-label="Direct link to Skip Tests with Exit Code 80" title="Direct link to Skip Tests with Exit Code 80">​</a></h3>
<p>If any testcase in a test file exist with exit code <code>80</code>, then all testcases in that file are skipped.</p>
<p>This is especially helpful for OS specific tests etc. Imagine:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Run tests in this file only on Mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```scrut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ [[ &quot;$(uname)&quot; == &quot;Darwin&quot; ]] || exit 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note:</strong> The code that Scrut accepts to skip a whole file can be modified with the <a href="/scrut/docs/advanced/file-formats/#testcase-configuration"><code>skip_document_code</code> configuration directive</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scrut-exit-code">Scrut Exit Code<a href="#scrut-exit-code" class="hash-link" aria-label="Direct link to Scrut Exit Code" title="Direct link to Scrut Exit Code">​</a></h3>
<p>Scrut itself communicates the outcome of executions with exit codes. Currently three possible exit codes are supported:</p>
<ul>
<li><code>0</code>: Command succeeded, all is good (<code>scrut test</code>, <code>scrut create</code>, <code>scrut update</code>)</li>
<li><code>1</code>: Command failed with error (<code>scrut test</code>, <code>scrut create</code>, <code>scrut update</code>)</li>
<li><code>50</code>: Validation failed (<code>scrut test</code> only)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="newline-handling">Newline handling<a href="#newline-handling" class="hash-link" aria-label="Direct link to Newline handling" title="Direct link to Newline handling">​</a></h2>
<p><a href="https://en.wikipedia.org/wiki/Newline" target="_blank" rel="noopener noreferrer">Newline</a> endings is a sad story in computer history. In Unix / MacOS ( / *BSD / Amiga / ..) the standard line ending is the line feed (LF) character <code>\n</code>. Windows (also Palm OS and OS/2?) infamously attempted to make a combination of carriage return (CR) and line feed the standard: CRLF (<code>\r\n</code>). Everybody got mad and still is.</p>
<p>See the <a href="/scrut/docs/advanced/file-formats/#testcase-configuration"><code>keep_crlf</code> configuration directive</a> to understand how Scrut handles LF and CRLF and how you can modify the default behavior.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="execution-environment">Execution Environment<a href="#execution-environment" class="hash-link" aria-label="Direct link to Execution Environment" title="Direct link to Execution Environment">​</a></h2>
<p>A <a href="/scrut/docs/advanced/file-formats/">Scrut test file</a> can contain arbitrary amounts of tests. Scrut provides a shared execution environment for all tests within a single file, which comes with certain behaviors and side-effects that should be known:</p>
<ul>
<li><strong>Shared Shell Environment</strong>: Each subsequent testcase in the same file inherits the shell environment of the previous testcase. This means: All environment variables, shell variables, aliases, functions, etc that have are set in test are available to the immediate following test.<!-- -->
<ul>
<li><em>Exception</em>: Environments from <a href="/scrut/docs/advanced/file-formats/#testcase-configuration"><code>detached</code></a> testcases are not passed along</li>
</ul>
</li>
<li><strong>Shared Ephemeral Directories</strong>: Each testcase in the same test file executes in the the same work directory and is provided with the same temporary directory (<a href="#test-environment-variables"><code>$TEMPDIR</code></a>). Both directories will be removed (cleaned up) after test execution - independent of whether the test execution succeeds or fails.<!-- -->
<ul>
<li><em>Exception</em>: If the <code>--work-directory</code> command-line parameter is provided, then this directory will not be cleaned up (deleted) after execution. A temporary directory, that will be removed after execution, will be created within the working directory.</li>
</ul>
</li>
<li><strong>Process Isolation</strong>: Scrut starts individual <code>bash</code> processes for executing each testcase of the same test file. Each shell expression. The environment of the previous execution is pulled in through a shared <code>state</code> file, that contains all environment variables, shell variables, aliases, functions and settings as they were set when the the previous testcase execution ended.<!-- -->
<ul>
<li><em>Exception</em>: All testcases in cram files are currently executed within the same <code>bash</code> process - this is likely to change in the future.</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://www.internalfb.com/code/fbsource/fbcode/clifoundation/scrut/website/docs/advanced/specifics.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/scrut/docs/advanced/expectations/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Expectations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/scrut/docs/advanced/development/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Development</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#test-output" class="table-of-contents__link toc-highlight">Test output</a><ul><li><a href="#pretty-renderer-default" class="table-of-contents__link toc-highlight">Pretty Renderer (default)</a></li><li><a href="#diff-renderer" class="table-of-contents__link toc-highlight">Diff renderer</a></li><li><a href="#json-and-yaml-renderer" class="table-of-contents__link toc-highlight">JSON and YAML renderer</a></li></ul></li><li><a href="#test-environment-variables" class="table-of-contents__link toc-highlight">Test environment variables</a><ul><li><a href="#scrut-specific-environment-variables" class="table-of-contents__link toc-highlight">Scrut specific environment variables</a></li><li><a href="#common-linux-environment-variables" class="table-of-contents__link toc-highlight">Common (linux) environment variables</a></li><li><a href="#optional-cram-environment-variables" class="table-of-contents__link toc-highlight">(Optional) Cram environment variables</a></li></ul></li><li><a href="#test-work-directory" class="table-of-contents__link toc-highlight">Test work directory</a></li><li><a href="#test-execution" class="table-of-contents__link toc-highlight">Test execution</a><ul><li><a href="#execution-within-a-custom-shell" class="table-of-contents__link toc-highlight">Execution within a custom shell</a></li></ul></li><li><a href="#stdout-and-stderr" class="table-of-contents__link toc-highlight">STDOUT and STDERR</a></li><li><a href="#exit-codes" class="table-of-contents__link toc-highlight">Exit Codes</a><ul><li><a href="#skip-tests-with-exit-code-80" class="table-of-contents__link toc-highlight">Skip Tests with Exit Code 80</a></li><li><a href="#scrut-exit-code" class="table-of-contents__link toc-highlight">Scrut Exit Code</a></li></ul></li><li><a href="#newline-handling" class="table-of-contents__link toc-highlight">Newline handling</a></li><li><a href="#execution-environment" class="table-of-contents__link toc-highlight">Execution Environment</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.fb.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use</a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Meta Platforms, Inc</div></div></div></footer></div>
</body>
</html>