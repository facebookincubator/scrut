"use strict";(self.webpackChunkstaticdocs_starter=self.webpackChunkstaticdocs_starter||[]).push([[4653],{8607:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>c,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"reference/custom-shell","title":"Custom Shell","description":"While Scrut currently only supports bash (>= 3.2) a custom shell can be provided with the --shell command line parameter.","source":"@site/docs/reference/custom-shell.md","sourceDirName":"reference","slug":"/reference/custom-shell","permalink":"/scrut/docs/reference/custom-shell","draft":false,"unlisted":false,"editUrl":"https://www.internalfb.com/code/fbsource/fbcode/clifoundation/scrut/website/docs/reference/custom-shell.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Working Directory","permalink":"/scrut/docs/reference/behavior/working-directory"}}');var r=n(74848),o=n(28453);const c={},i="Custom Shell",l={},h=[];function a(e){const s={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"custom-shell",children:"Custom Shell"})}),"\n",(0,r.jsxs)(s.p,{children:["While Scrut currently only supports ",(0,r.jsx)(s.code,{children:"bash"})," (>= 3.2) a custom shell can be provided with the ",(0,r.jsx)(s.code,{children:"--shell"})," command line parameter.\nTo understand how that works consider the following:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",metastring:'title="Terminal"',children:'$ echo "echo Hello" | /bin/bash -\nHello\n'})}),"\n",(0,r.jsxs)(s.p,{children:["What the above does is piping the string ",(0,r.jsx)(s.code,{children:"echo Hello"})," into the ",(0,r.jsx)(s.code,{children:"STDIN"})," of the process that was started with ",(0,r.jsx)(s.code,{children:"/bin/bash -"}),".\nScrut pretty much does the same with each shell expressions within a test file."]}),"\n",(0,r.jsxs)(s.p,{children:["So why provide a custom ",(0,r.jsx)(s.code,{children:"--shell"})," then?\nThis becomes useful in at least two scenarios:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"You need to execute the same code before Scrut runs each individual expression"}),"\n",(0,r.jsx)(s.li,{children:"You need Scrut to redirect the execution, for example an isolated environment"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"For (1) consider the following code:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",metastring:'title="my_custom_setup.sh"',children:"#!/bin/bash\n\n# do something in this wrapper script\nsource /my/custom/setup.sh\nrun_my_custom_setup\n\n# consume and run STDIN\nsource /dev/stdin\n"})}),"\n",(0,r.jsx)(s.p,{children:"For (2) consider the following:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",metastring:'title="my_remote_execution.sh"',children:"#!/bin/bash\n\n# do something in this wrapper script\nsource /my/custom/setup.sh\nrun_my_custom_setup\n\n# end in a bash process that will receive STDIN\nexec ssh username@acme.tld /bin/bash\n"})})]})}function d(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>i});var t=n(96540);const r={},o=t.createContext(r);function c(e){const s=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(o.Provider,{value:s},e.children)}}}]);